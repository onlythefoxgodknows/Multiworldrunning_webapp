const canvas = document.getElementById('screen');
const ctx = canvas.getContext('2d');

import Wall1 from "./tiles/Wall1.js";
import {loadImage} from "./utils/loader.js";

//load all images
let map = new Map();

const wallsConfig = [
    {name: "wall1", imagePath: "./img/bricks_1.png"},
    {name: "wall2", imagePath: "./img/bricks_2.png"},
    {name: "wall3", imagePath: "./img/bricks_1.png"},
];
const gameMap = [
    ["x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x"],
    ["x", "d", "d", "d", "d", "d", "d", "d", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "x"],
    ["x", "g", "h", " ", " ", " ", " ", " ", " ", " ", "i", " ", " ", " ", " ", " ", "i", " ", "E", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "E", " ", " ", " ", " ", " ", " ", "i", " ", " ", "x"],
    ["x", "d", "d", "d", "d", "d", "d", "d", "d", "d", " ", "d", "d", "d", " ", " ", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", " ", " ", " ", " ", "x"],
    ["x", "v", " ", " ", "v", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "m", " ", " ", " ", " ", "x"],
    ["x", " ", " ", " ", " ", " ", "i", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "m", " ", " ", "x"],
    ["x", "FR", " ", " ", " ", " ", "m", " ", " ", " ", " ", " ", " ", " ", " ", "i", " ", "-", "-", "-", "-", " ", "i", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "m", " ", "x"],
    ["x", " ", " ", " ", " ", " ", "m", " ", " ", " ", " ", "E", " ", " ", " ", " ", "o", "o", "o", "o", "o", "o", " ", " ", " ", " ", " ", " ", " ", "E", "E", " ", " ", " ", " ", " ", " ", " ", " ", "x"],
    ["x", " ", " ", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "m", "x"],
    ["x", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "x"],
    ["x", " ", " ", " ", " ", " ", " ", "m", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "x"],
    ["x", "m", "m", "m", "m", "m", "m", "m", "m", "m", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "FR", "FR", " ", " ", " ", " ", " ", " ", "x"],
    ["x", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "x"],
    ["x", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "FR", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "x"],
    ["x", " ", " ", " ", " ", " ", " ", " ", " ", "i", "-", "-", " ", "i", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "m", " ", " ", "x"],
    ["x", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "m", "m", " ", "m", "x"],
    ["x", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "i", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "-", "-", "-", " ", " ", " ", " ", "i", " ", " ", "m", "w", "m", "x"],
    ["x", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "m", "w", "m", "x"],
    ["x", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "m", "w", "m", "x"],
    ["x", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "m", "w", "m", "x"],
    ["x", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "F", " ", " ", "i", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "m", "w", "m", "x"],
    ["x", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "m", "w", "m", "x"],
    ["x", "i", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "i", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "m", " ", " ", " ", "m", "m", "m", "w", "m", "x"],
    ["x", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "i", " ", "-", "-", "-", "-", "-", "-", " ", " ", " ", " ", " ", " ", "i", "m", "w", "w", "w", "w", "w", "w", "w", "m", "x"],
    ["x", "FR", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "m", "w", "w", "w", "w", "w", "w", "w", "m", "x"],
    ["x", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "m", "w", "w", "w", "w", "w", "w", "w", "m", "x"],
    ["x", " ", "i", " ", " ", " ", " ", " ", " ", "m", "i", "-", "-", " ", "i", " ", "-", "-", " ", "i", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "m", "m", "m", "m", "m", "m", "m", "m", "m", "x"],
    ["x", " ", " ", " ", " ", " ", " ", " ", " ", "m", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "x"],
    ["x", " ", " ", " ", "-", "-", "-", "i", " ", "m", " ", " ", " ", "i", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "x"],
    ["x", " ", " ", " ", " ", " ", " ", " ", " ", "m", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "x"],
    ["x", " ", " ", "E", " ", " ", " ", " ", " ", "d", "i", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "x"],
    ["x", "x", "x", "x", "x", "x", "x", "x", "x", "x", " ", " ", " ", " ", " ", " ", " ", " ", " ", "-", "-", "-", "-", "-", " ", " ", " ", "i", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "x"],
    ["x", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "x"],
    ["x", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "i", " ", " ", " ", " ", " ", " ", " ", "x"],
    ["x", " ", " ", " ", " ", " ", " ", " ", " ", "i", " ", " ", " ", " ", " ", "-", "-", " ", " ", " ", " ", " ", " ", " ", " ", "i", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "x"],
    ["x", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "x"],
    ["x", "-", "-", " ", " ", " ", " ", " ", "i", " ", "-", "-", "-", " ", " ", " ", " ", "i", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "x"],
    ["x", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "-", " ", " ", " ", " ", " ", " ", " ", " ", "-", "-", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "x"],
    ["x", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "o", "x", "x", "x", "x", "x"],
    ["x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x", "x"]
]

function loadWallImages(wallsConfig) {
    let countLoadImages = 0;

    wallsConfig.forEach(wall => {
        loadImage(wall.imagePath).then(img => {
            countLoadImages++;
            map.set(wall.name, img);
            if (countLoadImages === wallsConfig.length) {
                main();
            }
        });
    });
}

function loadPlayerSpriteSheet() {

}

loadWallImages(wallsConfig);

function main() {

    for (let row = 0; row < gameMap.length; row++) {
        for (let col = 0; col < gameMap[row].length; col++) {
            if (gameMap[row][col] === "x") {
                const wall1 = new Wall1("wall1", col * 40, row * 40, 40, 40);
                wall1.render(ctx, map.get(wall1.name));
            }
        }
    }
}



